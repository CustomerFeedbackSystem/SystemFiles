var animatedcollapse={divholders:{},divgroups:{},lastactiveingroup:{},preloadimages:[],show:function(e){if(typeof e=="object"){for(var t=0;t<e.length;t++)this.showhide(e[t],"show")}else this.showhide(e,"show")},hide:function(e){if(typeof e=="object"){for(var t=0;t<e.length;t++)this.showhide(e[t],"hide")}else this.showhide(e,"hide")},toggle:function(e){if(typeof e=="object")e=e[0];this.showhide(e,"toggle")},addDiv:function(e,t){this.divholders[e]={id:e,$divref:null,attrs:t};this.divholders[e].getAttr=function(e){var t=new RegExp(e+"=([^,]+)","i");return t.test(this.attrs)&&parseInt(RegExp.$1)!=0?RegExp.$1:null};this.currentid=e;return this},showhide:function(e,t){var n=this.divholders[e].$divref;if(this.divholders[e]&&n.length==1){var r=this.divgroups[n.attr("groupname")];if(n.attr("groupname")&&r.count>1&&(t=="show"||t=="toggle"&&n.css("display")=="none")){if(r.lastactivedivid&&r.lastactivedivid!=e)this.slideengine(r.lastactivedivid,"hide");this.slideengine(e,"show");r.lastactivedivid=e}else{this.slideengine(e,t)}}},slideengine:function(e,t){var n=this.divholders[e].$divref;var r=this.divholders[e].$togglerimage;if(this.divholders[e]&&n.length==1){var i={height:t};if(n.attr("fade"))i.opacity=t;n.animate(i,n.attr("speed")?parseInt(n.attr("speed")):500,function(){if(r){r.attr("src",n.css("display")=="none"?r.data("srcs").closed:r.data("srcs").open)}if(animatedcollapse.ontoggle){try{animatedcollapse.ontoggle(jQuery,n.get(0),n.css("display"))}catch(e){alert('An error exists inside your "ontoggle" function:\n\n'+e+"\n\nAborting execution of function.")}}});return false}},generatemap:function(){var e={};for(var t=0;t<arguments.length;t++){if(arguments[t][1]!=null){e[arguments[t][0]]=arguments[t][1]}}return e},init:function(){var e=this;jQuery(document).ready(function(t){animatedcollapse.ontoggle=animatedcollapse.ontoggle||null;var n=animatedcollapse.urlparamselect();var r=e.getCookie("acopendivids");var i=e.getCookie("acgroupswithpersist");if(r!=null)r=r=="nada"?[]:r.split(",");i=i==null||i=="nada"?[]:i.split(",");jQuery.each(e.divholders,function(){this.$divref=t("#"+this.id);if((this.getAttr("persist")||jQuery.inArray(this.getAttr("group"),i)!=-1)&&r!=null){var s=jQuery.inArray(this.id,r)!=-1?"block":"none"}else{var s=this.getAttr("hide")?"none":null}if(n[0]=="all"||jQuery.inArray(this.id,n)!=-1){s="block"}else if(n[0]=="none"){s="none"}this.$divref.css(e.generatemap(["height",this.getAttr("height")],["display",s]));this.$divref.attr(e.generatemap(["groupname",this.getAttr("group")],["fade",this.getAttr("fade")],["speed",this.getAttr("speed")]));if(this.getAttr("group")){var o=e.divgroups[this.getAttr("group")]||(e.divgroups[this.getAttr("group")]={});o.count=(o.count||0)+1;if(jQuery.inArray(this.id,n)!=-1){o.lastactivedivid=this.id;o.overridepersist=1}if(!o.lastactivedivid&&this.$divref.css("display")!="none"||s=="block"&&typeof o.overridepersist=="undefined")o.lastactivedivid=this.id;this.$divref.css({display:"none"})}});jQuery.each(e.divgroups,function(){if(this.lastactivedivid&&n[0]!="none")e.divholders[this.lastactivedivid].$divref.show()});if(animatedcollapse.ontoggle){jQuery.each(e.divholders,function(){animatedcollapse.ontoggle(jQuery,this.$divref.get(0),this.$divref.css("display"))})}var s=t("a[rel]").filter('[rel^="collapse["], [rel^="expand["], [rel^="toggle["]');s.each(function(){this._divids=this.getAttribute("rel").replace(/(^\w+)|(\s+)/g,"").replace(/[\[\]']/g,"");if(this.getElementsByTagName("img").length==1&&e.divholders[this._divids]){animatedcollapse.preloadimage(this.getAttribute("data-openimage"),this.getAttribute("data-closedimage"));$togglerimage=t(this).find("img").eq(0).data("srcs",{open:this.getAttribute("data-openimage"),closed:this.getAttribute("data-closedimage")});e.divholders[this._divids].$togglerimage=t(this).find("img").eq(0);e.divholders[this._divids].$togglerimage.attr("src",e.divholders[this._divids].$divref.css("display")=="none"?$togglerimage.data("srcs").closed:$togglerimage.data("srcs").open)}t(this).click(function(){var e=this.getAttribute("rel");var t=this._divids==""?[]:this._divids.split(",");if(t.length>0){animatedcollapse[/expand/i.test(e)?"show":/collapse/i.test(e)?"hide":"toggle"](t);return false}})});t(window).bind("unload",function(){e.uninit()})})},uninit:function(){var e="",t="";jQuery.each(this.divholders,function(){if(this.$divref.css("display")!="none"){e+=this.id+","}if(this.getAttr("group")&&this.getAttr("persist"))t+=this.getAttr("group")+","});e=e==""?"nada":e.replace(/,$/,"");t=t==""?"nada":t.replace(/,$/,"");this.setCookie("acopendivids",e);this.setCookie("acgroupswithpersist",t)},getCookie:function(e){var t=new RegExp(e+"=[^;]*","i");if(document.cookie.match(t))return document.cookie.match(t)[0].split("=")[1];return null},setCookie:function(e,t,n){if(typeof n!="undefined"){var r=new Date;r.setDate(r.getDate()+n);document.cookie=e+"="+t+"; path=/; expires="+r.toGMTString()}else document.cookie=e+"="+t+"; path=/"},urlparamselect:function(){window.location.search.match(/expanddiv=([\w\-_,]+)/i);return RegExp.$1!=""?RegExp.$1.split(","):[]},preloadimage:function(){var e=this.preloadimages;for(var t=0;t<arguments.length;t++){if(arguments[t]&&arguments[t].length>0){e[e.length]=new Image;e[e.length-1].src=arguments[t]}}}}